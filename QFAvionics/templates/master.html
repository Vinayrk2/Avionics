<!DOCTYPE html>
<html lang="en">

<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QF Avionics</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/index.css' %}">
    <link rel="shortcut icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon">
    <style>
        #dropdown {
            display: none;
            position: absolute;
            background-color: white;
            border: 1px solid #ccc;
            list-style: none;
            padding: 0;
            margin: 0;
            z-index: 1000;
        }

        #menu {
            margin-left: 10px;
        }

        #menu:hover #dropdown {
            display: block;


            /* Show dropdown on hover */
        }

        #dropdown li {
            padding: 10px;
            /* Add some padding */
        }

        #dropdown li:hover {
            background-color: #f0f0f0;
            /* Change background on hover */
        }

        .icon-container {
            display: flex;
            align-items: center;
            /* Aligns icons vertically */
        }

        .icon-container a {
            margin-right: 1rem;
            /* Adjusts space between icons */
        }

        .icon-container a:last-child {
            margin-right: 0;
            /* Removes margin from the last icon */
        }

        /* search box style */
        #searchbox {
            top: -100vh;
            background-color: rgba(0, 0, 0, 0.247);
            width: 100%;
            /* z-index: 1000; */
            margin-top: -70px;
            padding: 130px 0px 10px 0px;
        }

        #searchform {
            width: 80%;
            background-color: rgb(223, 223, 223);
            border-radius: 5px;
            padding: 35px 13px 13px 13px;
        }

        @media (max-width: 500px) {
            #searchform {
                width: 100%;
            }
        }

        #searchinput {
            width: 100%;
            height: 40px;
            border-radius: 5px;
            border: none;
            padding-left: 10px;
        }

        #searchbtn {
            background-color: #090841;
            border-radius: 5px;
            padding: 0px 10px;
            color: white;
            border: none;
        }

        .iframe-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .iframe-content {
            background-color: white;
            border-radius: 8px;
            width: 90%;
            max-width: 800px;
            height: 80%;
            display: flex;
            flex-direction: column;
        }

        .iframe-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid #dee2e6;
        }

        .iframe-body {
            flex-grow: 1;
            overflow: hidden;
        }

        iframe {
            width: 100%;
            height: 80vh;
            border: none;
        }

        @media (max-width: 991.98px) {
            #companyname {
                font-size: 20px;
                position: absolute;
                margin: 110px 0px 0px 50px;
                color: #090841;
                z-index: 400;
            }

            @media (max-width: 575px) {
                #companyname {
                    margin: 135px 0px 0px 45px;
                }
            }
        }

        .loader {
            display: flex;
            justify-content: center;
            align-items: center;
            position: fixed;
            top: 0;
            box-sizing: border-box;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            overflow-y: hidden;
            margin: 0;
            padding: 0;
            z-index: 300;
            background-color: rgba(0, 0, 0, 0.774);
            display: none;
        }

        #round {
            height: 50px;
            width: 50px;
            border: 5px solid white;
            border-top-color: transparent;
            border-bottom-color: transparent;
            border-radius: 50%;
            animation-name: loading;
            animation-duration: 2s;
            animation-timing-function: cubic-bezier(0.075, 0.82, 0.165, 1);
            animation-iteration-count: infinite;
        }

        #loading_text {
            color: white;
            font-weight: bolder;
            transform: translate(-22%);
            margin-top: 2%;
        }

        @keyframes loading {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>

</head>

<body>

    <div class="loader" id="loading">
        <div>
            <div id="round"></div>
            <div id="loading_text"> Processing... </div>
        </div>

    </div>

    <main id="mainbox" class="">
        <div class="top-bar">
            <div class="container-fluid d-flex justify-content-between align-items-center">
                <div class="d-sm-flex" style="cursor: pointer; color: rgb(160, 160, 160);">
                    <div class="me-3 "><i class="fas fa-phone"></i> {{header.phone_number|default:"+1 (403) 886-4306"}}
                    </div>
                    <div class="me-3" id="emailButton"><i class="fas fa-envelope"></i>
                        {{header.email|default:"info@qfavionics.com"}}</div>
                </div>
                <h3 id="companyname" style="letter-spacing: 1px;">QF Avionics</h3>
                <div class="d-sm-flex">
                    <div class="d-flex justify-content-center align-items-center" style="margin-top: -6px;">
                        <a href="{{footer.instagram|default_if_none:" #" }}" class="text-white mt-2 me-2"><i
                                class="fa-brands fa-instagram fs-6"></i></a>
                        <a href="{{footer.youtube|default_if_none:" #" }}" class="text-white mt-2 me-2"><i
                                class="fa-brands fa-youtube fs-6"></i></a>
                        <a href="{{footer.linkedin|default_if_none:" #" }}" class="text-white mt-2 me-2"><i
                                class="fa-brands fa-linkedin fs-6"></i></a>
                    </div>
                    <select class="form-select" id="currency-value" aria-label="Default select example"
                        style="height: 35px; width: 105px;">
                        {% if request.session.currency == "USD" %}
                        <option value="USD" data-bs-toggle="tooltip" data-bs-placement="bottom"
                            title="Click to see product price in USD currency" selected>ðŸ’²USD</option>
                        <option value="CAD" data-bs-toggle="tooltip" data-bs-placement="bottom"
                            title="Click to see product price in CAD currency">ðŸ’²CAD</option>
                        {% else %}
                        <option value="USD">ðŸ’²USD</option>
                        <option value="CAD" selected>ðŸ’²CAD</option>
                        {% endif %}
                    </select>
                </div>
            </div>
        </div>

        <nav class="position-absolute navbar navbar-expand-lg navbar-light bg-white w-100 "
            style="z-index: 200;box-sizing: border-box;">
            <!-- search box -->
            <div id="searchbox" class="d-flex justify-content-center position-absolute">
                <form id="searchform" class="d-flex" action="{% url 'search'  %}" method="get" onsubmit="return searchfunc();">
                    <p id="searchmsg" class="text-danger position-absolute" style="margin-top: -38px; font-size: 15px;"></p>
                    <input id="searchinput" type="text" name="q" placeholder="Enter Keyword . . .">&nbsp;
                    <button id="searchbtn" type="submit">Search</button>
                    <input type="hidden" name="page" value="1">
                    <svg id="searchcancel" xmlns="http://www.w3.org/2000/svg" width="22" height="22"
                        style="margin: -30px -7px 0px 0px; cursor: pointer;" fill="currentColor" class="bi bi-x-lg"
                        viewBox="0 0 16 16">
                        <path
                            d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z" />
                    </svg>
                </form>
            </div>

            <div class="container-fluid border-bottom">
                <a class="navbar-brand" href="{% url 'home' %}">
                    <img src="{% static 'images/logo.png' %}" alt="QF Avionics"
                        style="max-width: min(50px,50px); max-height: min(10vh,10vw);">
                </a>
                <a class="navbar-toggler" style="border: none; margin-right: -10px;" type="button"
                    data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <img src="{% static 'images/toggle.png' %}">
                </a>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav mx-auto">
                        <li class="nav-item">
                            <a class="nav-link md:mt-3" id="menu" href="{% url 'home' %}"><i
                                    class="fa-solid fa-house"></i> HOME</a>
                        </li>
                        <li class="nav-item" id="menu">
                            <a class="nav-link text-decoration-none"><i class="fa-solid fa-layer-group"></i>
                                SERVICES</a>
                            <ul id="dropdown" class="text-decoration-none">
                                {% comment %} <li>Airframe Wiring</li>
                                <li>Fixed Wings</li>
                                <li>Glass Cockpits</li>
                                <li>Rotorcraft</li>
                                <li>5G Radar Alimeters</li> {% endcomment %}
                                {% if services %}
                                {% for service in services %}
                                <a href="{% url 'service' id=service.id %}" class="text-decoration-none text-dark">
                                    <li>{{service.name}}</li>
                                </a>
                                {% endfor %}
                                {% endif %}
                            </ul>
                        </li>
                        <li class="nav-item" id="menu">
                            <a class="nav-link"><i class="fa-solid fa-bag-shopping"></i> SHOP</a>
                            <ul id="dropdown">
                                <a href="{% url 'product-list-categorized' name='all' %}"
                                    style="text-decoration:none; color:black;">
                                    <li> All Products </li>
                                </a>
                                {% for category in categories %}
                                <a href="{% url 'product-list-categorized' name=category %}"
                                    style="text-decoration:none; color:black;">
                                    <li>{{category}} </li>
                                </a>
                                {% endfor %}
                            </ul>
                        </li>
                        <li class="nav-item" id="menu">
                            <a class="nav-link" href="{% url 'view-news' %}"><i class="fa-solid fa-newspaper"></i>
                                NEWS</a>

                        </li>
                        <li class="nav-item" id="menu">
                            <a class="nav-link" href="{% url 'aboutpage' %}"><i class="fa-solid fa-address-card"></i>
                                ABOUT</a>

                        </li>
                        <li class="nav-item" id="menu">
                            <a class="nav-link" href="{% url 'contactpage' %}"><i class="fa-solid fa-address-book"></i>
                                CONTACT</a>

                        </li>
                    </ul>
                    <div class="icon-container d-flex mx-2 mt-2 mt-md-0 mb-3 mb-md-0">
                        {% if request.user.is_authenticated %}
                        <a href="{% url 'profile' %}"
                            class="text-dark me-3 text-decoration-none border px-3 py-1 rounded"><i
                                class="fas fa-user fs-6"></i> {{ user.username }}
                        </a>
                        {% else %}
                        <a href="{% url 'login' %}" class="text-dark me-3 fs-6"><i class="fas fa-user fs-6"></i> </a>
                        {% endif %}
                        <div>
                            <a href="{% url 'cart_detail' %}" class="text-dark me-3"><span
                                    class="position-absolute bg-dark text-white fw-bold px-1"
                                    style="font-size: 10px; border-radius: 100%; margin-top: -5px; margin-left: 8px;">{{no_of_items}}</span><i
                                    class="fas fa-shopping-cart fs-6"></i></a>
                        </div>
                        <a id="searchopen" class="text-dark"><i class="fas fa-search fs-6"></i></a>
                    </div>
                </div>
            </div>
        </nav>

        {% if messages %}
        <ul class="messages" style="margin-top: 12vh; position: absolute; z-index: 1000; right: 15px;">
            {% for message in messages %}
            <div class="alert alert-primary" role="alert" id="alert" style="margin-top: -10px;">
                {{ message }}</div>
            {% endfor %}
        </ul>
        {% endif %}

        {% block content %}
        {% endblock %}
    </main>

    <footer class="footer">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-3 mb-4">
                    <h5><i class="fa-solid fa-layer-group fs-6"></i> Services</h5>
                    <ul>
                        {% if services %}
                        {% for service in services|slice:":8" %}
                        <a href="{% url 'service' id=service.id %} " class="text-decoration-none text-secondary">
                            <li>{{service.name}}</li>
                        </a>
                        {% endfor %}
                        {% endif %}
                    </ul>
                </div>
                <div class="col-md-3 mb-4">
                    <h5><i class="fa-solid fa-link fs-6"></i> Important Links</h5>
                    <ul class="text-secondary">
                        {% if links %}
                        {% for link in links %}


                        <a href="{{link.url}}" target="_blank" class="text-decoration-none text-secondary">
                            <li>{{link.name}}</li>
                        </a>
                        {% endfor %}
                        {% endif %}
                    </ul>
                </div>
                <div class="col-md-3 mb-4">
                    <h5><i class="fa-solid fa-location-dot fs-6"></i> Location</h5>
                    <div class="text-secondary">
                        <a href="https://www.google.com/maps/dir//3801+Airport+Dr,+Springbrook,+AB+T4S+2E8/@52.1763421,-113.9696467,12z/data=!4m8!4m7!1m0!1m5!1m1!1s0x537450468fc942f9:0xb14e4971aebfab17!2m2!1d-113.8872465!2d52.1763708?entry=ttu&g_ep=EgoyMDI0MTAyMy4wIKXMDSoASAFQAw%3D%3D"
                            class="text-decoration-none text-secondary" target="_blank">
                            <pre class="text-secondary" style="font-size: 1rem;">{{footer.location}}</pre> </a>
                    </div>
                </div>
                <div class="col-md-3">
                    <h5><i class="fa-solid fa-hashtag"></i> Social Media Channel</h5>
                    <p class="text-secondary">Follow to get special offers, free giveaways, and once-in-a-lifetime
                        deals.</p>
                    <a href="{{footer.instagram|default_if_none:" #" }}" class="text-secondary mt-2 me-2"><i
                            class="fa-brands fa-instagram mx-1 fs-4"></i></a>
                    <a href="{{footer.youtube|default_if_none:" #"}}" class="text-secondary mt-2 me-2"><i
                            class="fa-brands fa-youtube mx-1 fs-4"></i></a>
                    <a href="{{footer.linkedin|default_if_none:" #"}}" class="text-secondary mt-2 me-2"><i
                            class="fa-brands fa-linkedin mx-1 fs-4"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        let searchcancel = document.querySelector('#searchcancel');
        let searchopen = document.querySelector('#searchopen');
        let searchmsg = document.querySelector('#searchmsg');

        // search input validation
        let searchfunc = () => {
            let searchinput = document.querySelector('#searchinput').value;

            setTimeout(() => {
                searchmsg.innerText = "";
            }, 5000);

        if (searchinput.length < 3) {
                searchmsg.innerText = "search text length must be greater then 3 characters!";
                return false;
            } else {
                searchmsg.innerText = "";
            }
            return true;
        }

        // search functionallity
        searchopen.addEventListener("click", () => {
            console.log("click")
            searchbox.style.top = "0vh";
            searchbox.style.transition = "0.3s";
        })

        searchcancel.addEventListener("click", () => {
            searchbox.style.top = "-100vh";
            searchbox.style.transition = "0.3s";
        })

        document.querySelector("#currency-value").addEventListener('change', (e) => {
            let selected = e.target.value;

            setCurrency(selected);
        })

        function setCurrency(currency) {
            console.log(currency)
            fetch("/set_currency/", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({ "currency": currency })
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        window.location.reload()
                    } else {
                        alert("Failed to set currency: " + data.error);
                    }
                })
                .catch(error => {
                    console.error("Error setting currency:", error);
                    alert("An error occurred while setting the currency.");
                });
        }

        window.addEventListener('load', () => {
            document.querySelectorAll(".alert").forEach((value, key) => {
                setTimeout(() => {
                    value.style.opacity = 0
                }, 2000 * (key + 1))
            })
        })

        document.getElementById("emailButton").addEventListener("click", function () {
            const email = '{{header.email|default:"info@qfavionics.com"}}';
            const subject = "Contact To Distributor";
            const body = "type your message here";

            const mailtoLink = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

            window.location.href = mailtoLink;
        });

        const showLoading = (e) => {
            document.getElementById("loading").style.display = "flex"
            document.querySelector("body").style.overflow = "hidden"
            return true
        }
    </script>
</body>

</html>